# ðŸ›’ Agent-S inspired from WebShop paper 
***[WebShop: Towards Scalable Real-World Web Interaction with Grounded Language Agents](https://webshop-pnlp.github.io/)***
  
## ðŸ“– Table of Contents <!-- omit in toc -->

* [ðŸš€ Setup](#-setup)
* [ðŸ› ï¸ Usage](#-usage)
* [ðŸ’« Contributions](#-contributions)

## ðŸš€ Setup
Our code is implemented in Python. To setup, do the following:
1. Install [Python 3.8.13](https://www.python.org/downloads/release/python-3813/)
2. Install [Java](https://www.java.com/en/download/)
3. Install [Ollama](https://ollama.com/download)
  * make sure to start Ollama server using command [ollama start] if using LLM for re-ranking
4. Download the source code:
```sh
> git clone https://github.com/PranaviPathakota/Agent-S.git agent_s
```
5. Create a virtual environment using [Anaconda](https://anaconda.org/anaconda/python) and activate it
```sh
> conda create -n agent_s python=3.8.13
> conda activate agent_s
```
6. Install requirements into the `agent_s` virtual environment via the `setup.sh` script
```sh
> ./setup.sh [-d small|all]
```
The setup script performs several actions in the following order:
* Installs Python dependencies listed in `requirements.txt`
* Downloads product and instruction data for populating WebShop
* Downloads `spaCy en_core_web_lg` model
* Construct search engine index from product, instruction data
* Downloads 50 randomly chosen trajectories generated by MTurk workers
The `-d` flag argument allows you to specify whether you would like to pull the entire product + instruction data set (`-d all`) or a subset of 1000 random products (`-d small`).

6. By default the WebShop only loads 1,000 products for a faster environment preview. To load all products, change `web_agent_site/utils.py`:
```python
# DEFAULT_ATTR_PATH = join(BASE_DIR, '../data/items_ins_v2_1000.json')
# DEFAULT_FILE_PATH = join(BASE_DIR, '../data/items_shuffle_1000.json')
DEFAULT_ATTR_PATH = join(BASE_DIR, '../data/items_ins_v2.json')
DEFAULT_FILE_PATH = join(BASE_DIR, '../data/items_shuffle.json')
```

7. (Optional) Download ResNet image feature files [here](https://drive.google.com/drive/folders/1jglJDqNV2ryrlZzrS0yOEk-aRAcLAhNw?usp=sharing) and put into `data/` for running models that require image features.

8. (Optional) Human demonstration data and be downloaded [here](https://drive.google.com/file/d/1GWC8UlUzfT9PRTRxgYOwuKSJp4hyV1dp/view?usp=sharing).

## ðŸ› ï¸ Usage
The WebShop environment can be rendered in two modes - `html` and `simple` - each of which offer a different observation space. The `simple` mode strips away the extraneous meta-data that the `html` mode includes to make model training and evaluation easier. 
### Webpage Environment (`html` mode)
Launch the `Agent-S` webpage:
```sh
> ./run_dev.sh
```
The site should then be viewable in the browser. Go to http://localhost:3000/ABC, where you should land on the search home page with a random instruction.

Navigating the website will automatically generate a corresponding trajectory file in the `user_session_logs/mturk` folder. Each file corresponds to a single instruction/web session, and each step of the file corresponds to a single action (i.e. `search[...]`, `click[...]`).


### Baseline Models
To run baseline models (rule, IL, RL, IL+RL), please refer to the `README.md` in the [baseline_models](https://github.com/PranaviPathakota/Agent-S.git/tree/master/baseline_models) folder. All the other considered implemented models such as sbert, t5, e5 are included in the baseline_models folder. 


## ðŸ’« Contributions
This is an experimentataion on Webshop paper where we contributed the following:
  1. Integrated Ollama for re-ranking the items displayed on Search results page
  2. Implemented various baseline models such as sbert, t5, roberta, mpnet methods along with BERT based model.
  3. Reproduced the results in the paper and shown a slight improvement in the IL based method.

